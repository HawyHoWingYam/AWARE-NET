研究課題：面向移動端防詐騙應用的級聯式異構集成 **Deepfake** 檢測模型研究

摘要

本研究旨在設計並實現一個專為移動端設計的高效、高精度Deepfake檢測應用原型，核心
目標是防範基於面部替換（Face Swap）技術的影片詐騙。為兼顧移動端嚴苛的性能限制與
高檢測精度的雙重需求，本研究提出並探索一種創新的混合架構，該架構深度融合了動態
模型級聯（ **Dynamic Model Cascade** ）與基於嵌入向量堆疊的異構模型集成（
**Embedding-based Stacking Ensemble** ）。系統將以離線處理模式（先保存後檢測）為主
要應用場景，並針對主流中端移動設備進行性能優化與部署。本研究的預期貢獻在於提供
一套完整的、從模型設計到移動端部署、兼具高精度與高效率的Deepfake檢測解決方案，
並通過一套綜合評估體系驗證其有效性。

**1.** 研究背景與問題定義

隨著生成式AI技術的普及，基於深度學習的影片偽造技術（Deepfake）已成為網絡詐騙、虛
假資訊傳播的嚴重威脅。特別是面部替換（Face Swap）技術，常被用於偽造親友、名人或官
方人員的影片，進行精準詐騙。儘管現有檢測模型在學術數據集上表現優異，但在計算資源
受限的移動設備上直接部署高精度重型模型面臨巨大挑戰。

```
● 研究範圍：本研究將嚴格限定在對 Face Swap 類型偽造影片的檢測，暫不涵蓋表情驅
動、音訊偽造等其他類型。
● 應用場景：核心應用為離線檢測模式。用戶可將來自社交軟體（如Zoom, Teams,
WhatsApp, WeChat等）的螢幕錄影，或其他可疑影片文件保存至本地，由本應用進行
深度分析，適用於事後取證、內容審核等場景。
```
**2.** 核心技術路徑

**2.1** 動態兩階段級聯架構 **(Dynamic Two-Stage Cascade)**

為解決精度與效率的矛盾，本方案採用級聯架構，將計算資源智能地分配給最需要的樣本。

```
● 第一階段 ( 快速過濾 ) ：使用一個計算開銷極低的輕量級模型
MobileNetV4-Hybrid-Medium 。此階段的目標是快速、準確地識別並過濾掉絕大部
分「簡單樣本」。
● 第二階段 ( 精準分析 ) ：僅對第一階段無法確定的「困難樣本」，啟用一個強大的異構集
成模型 (EfficientNetV2-B3 + GenConViT) 進行最終判決。
● 動態閾值策略 (Dynamic Threshold Strategy)：
為提升級聯策略的適應性，將採用基於影片整體不確定性的自適應閾值。
```
1. 概率校準：首先，對MobileNetV4模型在驗證集上進行溫度縮放（ **Temperature**
    **Scaling** ），使其輸出的置信度能更準確地反映真實概率。
2. 自適應調整：對輸入影片進行初次掃描，計算所有幀置信度的標準差。若標準差高
    （影片難度大），則擴大「困難樣本」的置信度區間（如 [0.2, 0.8]）；若標準差低（影片
    難度小），則收緊區間（如 [0.4, 0.6]），從而實現動態調整。


```
● 風險評估與控制 (Risk Assessment & Control)：
為嚴格控制第一階段的假陰性風險（即漏掉偽造樣本），將採用非對稱性保守閾值策
略。
```
1. 策略定義：僅當置信度極高（如 **> 0.98** ） 時，才判定為「簡單真實樣本」並放行。而所
    有置信度在 [0.1, 0.98] 之間的樣本，均視為「困難樣本」送入第二階段。
2. 評估指標：引入**「第一階段洩漏率 (Stage-1 Leakage Rate)」** 作為關鍵風險指
    標，用以量化在測試集中，應為偽造的樣本被第一階段錯誤放過的比例。目標是將
    此比率降至最低。

**2.2** 基於堆疊的異構集成 **(Stacking-based Heterogeneous Ensemble)**

```
● 基礎模型與協同作用 (Base Models & Synergy) ：
○ EfficientNetV2-B3 ：作為頂級的卷積神經網絡（CNN），預期其更擅長捕捉由偽造
過程引入的局部紋理異常、頻域噪點和邊緣不一致性。
○ GenConViT ：作為卷積-Transformer混合模型，預期其能利用自註意力機制，有效
建模影片幀內乃至幀間的全局語義不一致性、光照與陰影的異常關係等宏觀破綻。
● 融合策略：嵌入向量堆疊 (Fusion Strategy: Embedding Vector Stacking)：
採用堆疊（Stacking）方法，並以梯度提升樹（如LightGBM） 作為元模型。
```
1. 輸入：元模型的輸入並非單純的置信度分數，而是從兩個基礎模型分類頭之前的嵌
    入層（ **Embedding Layer** ） 提取的特徵向量。
2. 對齊與拼接：通過獨立的全連接層將兩個不同維度的嵌入向量投影到統一維度（如
    256 維），然後進行拼接，形成一個信息更豐富的、更高維的輸入特徵。
3. 訓練流程：為防止數據洩漏，將採用嚴格的 **K-Fold** 交叉驗證策略來生成用於訓練
    元模型的數據集。

**2.3** 移動端部署與優化 **(Mobile Deployment & Optimization)**

```
● 性能目標：本研究旨在將模型部署於搭載2022-2025年間發布的中端晶片組（如高通驍
龍 7 系、聯發科天璣 8000 系）的智能手機上，並設定具體的、可量化的延遲與精度目
標。
● 精度優先的優化策略 (Accuracy-First Optimization Strategy)：
為在模型壓縮過程中最大程度地保留精度，將採用量化感知訓練（
Quantization-Aware Training, QAT） 與知識蒸餾（Knowledge Distillation, KD） 相結合
的先進策略。
```
1. 教師模型：將PC端訓練的、未經量化的高精度完整集成模型作為「教師」。
2. 學生模型：將部署於移動端的量化版模型作為「學生」。
3. 訓練過程：在對學生模型進行QAT時，不僅使其學習真實標籤，還引入蒸餾損失，
    使其模仿教師模型的輸出，從而繼承教師模型的泛化能力，最大限度地減少精度
    損失。
**3.** 數據集與評估體系


## 3.1 數據集策略

```
● 訓練集 (Training Set) ：構建一個大規模、高質量的多樣化訓練集，包含： DF40 ,
DFDC , Celeb-DF-v2 , FaceForensics++ 。將嚴格使用這些數據集的官方訓練集（
Training Set）和驗證集（Validation Set）進行模型訓練與調優。
● 測試集 (Test Set) ：為確保評估的公正性和客觀性，測試集將與訓練集完全分離，無任
何交集。測試集將由以下部分組成：
```
1. 跨數據集泛化測試：Celeb-DF-v2 和 FaceForensics++ 的官方獨立測試集。
2. 真實世界場景泛化測試：完整的 **Deepfake-Eval-2024** 數據集，作為檢驗模型在
    複雜現實環境中表現的黃金標準。

**3.2** 綜合評估指標

本研究將建立一套多維度的評估體系，以全面衡量整個級聯系統的性能。

```
● 模型精度指標：在各測試集上計算標準的分類指標，包括 AUC-ROC 、準確率（
Accuracy ）、 F1-Score 。
● 系統級性能指標：
```
1. 系統總精度：評估整個級聯模型從輸入到輸出的端到端準確率。
2. 平均處理延遲：綜合考慮第一階段的快速處理和第二階段的慢速處理，計算處理每
    幀或每段影片的加權平均耗時。
3. 計算資源節約指標：量化對比本級聯方案與直接使用重型集成模型的方案在
    FLOPs或實際延遲上的節約比例。
● 泛化與魯棒性評估：
1. 跨偽造技術測試：在訓練時從DF40中保留部分偽造技術，專門用於測試模型對未
知攻擊的泛化能力。
2. 數據擾動魯棒性測試：對測試集人工加入高強度壓縮、噪點、模糊等擾動，評估模
型性能的下降曲線。
**4.** 預期貢獻

## 📊 **項目實施進度 (2025-07-23)**

### ✅ **已完成階段**
- **✅ 階段零**: 項目基礎與環境建設 - Python 3.12 + PyTorch nightly + GPU加速預處理
- **✅ 階段一**: 第一階段模型 (快速過濾器) - MobileNetV4-Hybrid-Medium 實現完成
  - 訓練腳本: `src/stage1/train_stage1.py`
  - 校準腳本: `src/stage1/calibrate_model.py`  
  - 評估腳本: `src/stage1/evaluate_stage1.py`
  - 用戶文檔: `docs/stage1_user_guide.md`

### 🔄 **待實施階段**
- **🔄 階段二**: 第二階段模型 (精準分析器) - EfficientNetV2-B3 + GenConViT
- **🔄 階段三**: 堆疊集成與元模型訓練 - LightGBM元模型
- **🔄 階段四**: 級聯系統整合與移動端優化 - QAT+KD優化
- **🔄 階段五**: 綜合評估與分析 - 跨數據集評估

### 🎯 **當前里程碑**
項目已完成第一個重要里程碑 - Stage 1 快速過濾器的完整實現。可以開始進行 Stage 1 模型訓練以建立性能基準。

## 📈 **研究貢獻目標**
1. 提出並驗證一種動態級聯架構，能根據影片難度自適應調整計算負載，為移動端高效檢測提供新思路。
2. 實現一個基於嵌入向量堆疊的異構集成模型，證明其在Deepfake檢測任務中相比單一模型的優越性。
3. 提供一套完整的、精度優先的移動端部署優化流程（ **QAT+KD** ），為高性能AI模型在資源受限設備上的落地提供實踐參考。
4. 建立一套綜合性、多維度的評估體系，能更全面、公允地衡量Deepfake檢測系統在真實世界中的潛在表現。


